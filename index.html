<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Pedidos - Chemes</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        @keyframes fadeSlideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade { animation: fadeSlideUp 0.5s ease-out both; }
        .delay-100 { animation-delay: 100ms; }
        .delay-200 { animation-delay: 200ms; }
        .delay-300 { animation-delay: 300ms; }
        .delay-400 { animation-delay: 400ms; }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100">

    <!-- Header -->
    <header class="bg-slate-900 text-white shadow-xl">
        <div class="max-w-7xl mx-auto px-6 py-5">
            <div class="flex items-center justify-between flex-wrap gap-4">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-gradient-to-br from-cyan-400 to-cyan-600 rounded-xl flex items-center justify-center shadow-lg">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl font-bold tracking-tight">Estado de Pedidos</h1>
                        <p class="text-slate-400 text-sm">Dashboard E-commerce Chemes</p>
                    </div>
                </div>
                
                <div class="flex items-center gap-4">
                    <!-- Selector de periodo -->
                    <div class="flex items-center gap-2 bg-slate-800 rounded-lg px-3 py-2">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                        <select id="selectPeriodo" class="bg-transparent text-white text-sm focus:outline-none cursor-pointer">
                            <option value="7" class="text-slate-900">Ultimos 7 dias</option>
                            <option value="15" class="text-slate-900">Ultimos 15 dias</option>
                            <option value="30" class="text-slate-900" selected>Ultimos 30 dias</option>
                            <option value="60" class="text-slate-900">Ultimos 60 dias</option>
                        </select>
                    </div>
                    
                    <!-- Boton actualizar -->
                    <button id="btnActualizar" class="flex items-center gap-2 bg-cyan-500 hover:bg-cyan-600 text-white px-4 py-2 rounded-lg transition-colors shadow-lg">
                        <svg id="iconRefresh" class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                        </svg>
                        <span class="text-sm font-medium">Actualizar</span>
                    </button>
                </div>
            </div>
            
            <div id="ultimaActualizacion" class="mt-3 text-xs text-slate-400"></div>
        </div>
    </header>

    <!-- Contenido principal -->
    <main class="max-w-7xl mx-auto px-6 py-8">
        
        <!-- Mensaje de error -->
        <div id="errorMsg" class="hidden mb-6 bg-rose-50 border border-rose-200 text-rose-700 px-4 py-3 rounded-xl flex items-center gap-3">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
            </svg>
            <span id="errorText"></span>
        </div>

        <!-- Metricas principales -->
        <div id="metricas" class="grid grid-cols-1 md:grid-cols-3 lg:grid-cols-5 gap-4 mb-6">
            <!-- Se llenan dinamicamente -->
        </div>

        <!-- Flujo visual -->
        <div id="flujoVisual" class="bg-white rounded-2xl shadow-lg p-6 mb-6 animate-fade delay-100">
            <!-- Se llena dinamicamente -->
        </div>

        <!-- Seccion Canales -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-slate-700 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                </svg>
                Detalle por Canal
            </h2>
            <div id="canales" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4">
                <!-- Se llenan dinamicamente -->
            </div>
        </div>

        <!-- Seccion Vendedores -->
        <div class="mb-8">
            <h2 class="text-xl font-semibold text-slate-700 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                </svg>
                Detalle por Vendedor
            </h2>
            <div id="vendedores" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4">
                <!-- Se llenan dinamicamente -->
            </div>
        </div>

        <!-- Footer -->
        <div class="mt-8 text-center text-sm text-slate-400">
            <p>Datos extraidos de Tango Gestion - Talonarios e-commerce: 234, 205</p>
            <p class="mt-1">Dashboard para Mariana y Silvina - Control de facturacion y logistica</p>
        </div>
    </main>

    <script>
        // =====================================================
        // CONFIGURACION - Modificar segun tu entorno
        // =====================================================
        const CONFIG = {
            // Opcion 1: Google Apps Script URL
            APPS_SCRIPT_URL: 'https://script.google.com/macros/s/AKfycbyaSUgKBwG8SR3RMdhogJ_1E73dFmChaTFwWu85XTn1EH6B2dTurlWpJa_2Oy2Agi7p/exec',
            
            // Opcion 2: URL directa al CSV (si esta en un servidor)
            CSV_URL: '',
            
            // Usar datos de ejemplo (true para pruebas, false para produccion)
            USAR_DATOS_EJEMPLO: false
        };

        // Datos de ejemplo para desarrollo
        const DATOS_EJEMPLO = [
            { OrdenGrupo: 0, OrdenFila: 0, TipoAgrupacion: 'CANAL', Nombre: 'Mercado Libre', Ordenes: 1752, Facturadas: 1751, PendFacturar: 1, Remitidas: 1702, SinRemitir: 49, ImportePendFacturar: 15000.00, ImportePendRemitir: 85000.00 },
            { OrdenGrupo: 0, OrdenFila: 0, TipoAgrupacion: 'CANAL', Nombre: 'PrestaShop', Ordenes: 626, Facturadas: 616, PendFacturar: 10, Remitidas: 561, SinRemitir: 55, ImportePendFacturar: 45000.00, ImportePendRemitir: 62000.00 },
            { OrdenGrupo: 0, OrdenFila: 0, TipoAgrupacion: 'CANAL', Nombre: 'Sin Canal', Ordenes: 91, Facturadas: 91, PendFacturar: 0, Remitidas: 82, SinRemitir: 9, ImportePendFacturar: 0, ImportePendRemitir: 12000.00 },
            { OrdenGrupo: 0, OrdenFila: 1, TipoAgrupacion: 'CANAL', Nombre: '** TOTAL **', Ordenes: 2469, Facturadas: 2458, PendFacturar: 11, Remitidas: 2345, SinRemitir: 113, ImportePendFacturar: 60000.00, ImportePendRemitir: 159000.00 },
            { OrdenGrupo: 1, OrdenFila: 0, TipoAgrupacion: 'VENDEDOR', Nombre: 'Juan Perez', Ordenes: 850, Facturadas: 845, PendFacturar: 5, Remitidas: 820, SinRemitir: 25, ImportePendFacturar: 18000.00, ImportePendRemitir: 45000.00 },
            { OrdenGrupo: 1, OrdenFila: 0, TipoAgrupacion: 'VENDEDOR', Nombre: 'Maria Garcia', Ordenes: 720, Facturadas: 718, PendFacturar: 2, Remitidas: 700, SinRemitir: 18, ImportePendFacturar: 8000.00, ImportePendRemitir: 32000.00 },
            { OrdenGrupo: 1, OrdenFila: 0, TipoAgrupacion: 'VENDEDOR', Nombre: 'Carlos Lopez', Ordenes: 540, Facturadas: 538, PendFacturar: 2, Remitidas: 520, SinRemitir: 18, ImportePendFacturar: 12000.00, ImportePendRemitir: 28000.00 },
            { OrdenGrupo: 1, OrdenFila: 0, TipoAgrupacion: 'VENDEDOR', Nombre: 'Carga inicial', Ordenes: 359, Facturadas: 357, PendFacturar: 2, Remitidas: 305, SinRemitir: 52, ImportePendFacturar: 22000.00, ImportePendRemitir: 54000.00 },
            { OrdenGrupo: 1, OrdenFila: 1, TipoAgrupacion: 'VENDEDOR', Nombre: '** TOTAL **', Ordenes: 2469, Facturadas: 2458, PendFacturar: 11, Remitidas: 2345, SinRemitir: 113, ImportePendFacturar: 60000.00, ImportePendRemitir: 159000.00 }
        ];

        // =====================================================
        // FUNCIONES AUXILIARES
        // =====================================================
        
        function formatNumber(num) {
            return num.toLocaleString('es-AR');
        }

        function formatCurrency(num) {
            return '$' + num.toLocaleString('es-AR', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
        }

        function calcularPorcentaje(valor, total) {
            return total > 0 ? ((valor / total) * 100).toFixed(1) : '0.0';
        }

        function getCanalIcon(canal) {
            const icons = {
                'Mercado Libre': 'üõí',
                'PrestaShop': 'üõçÔ∏è',
                'Web Chemes': 'üåê',
                'Sin Canal': 'üì¶'
            };
            return icons[canal] || 'üì¶';
        }

        function getVendedorIcon(vendedor) {
            if (vendedor === 'Carga inicial') return '‚öôÔ∏è';
            return 'üë§';
        }

        // =====================================================
        // RENDERIZADO
        // =====================================================

        function renderMetricas(totales) {
            const metricas = [
                { titulo: 'Total Ordenes', valor: totales.ordenes, subtitulo: 'Periodo: ' + document.getElementById('selectPeriodo').value + ' dias', color: 'blue', icon: 'M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4' },
                { titulo: 'Facturadas', valor: totales.facturadas, subtitulo: calcularPorcentaje(totales.facturadas, totales.ordenes) + '% del total', color: 'emerald', icon: 'M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z' },
                { titulo: 'Pend. Facturar', valor: totales.pendFacturar, subtitulo: formatCurrency(totales.importePendFact), color: 'amber', icon: 'M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z' },
                { titulo: 'Remitidas', valor: totales.remitidas, subtitulo: calcularPorcentaje(totales.remitidas, totales.facturadas) + '% de fact.', color: 'cyan', icon: 'M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4' },
                { titulo: 'Sin Remitir', valor: totales.sinRemitir, subtitulo: formatCurrency(totales.importePendRem), color: 'rose', icon: 'M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z' }
            ];

            const colorClasses = {
                blue: 'from-blue-500 to-blue-600',
                emerald: 'from-emerald-500 to-emerald-600',
                amber: 'from-amber-500 to-amber-600',
                cyan: 'from-cyan-500 to-cyan-600',
                rose: 'from-rose-500 to-rose-600'
            };

            document.getElementById('metricas').innerHTML = metricas.map(function(m, i) {
                return '<div class="bg-white rounded-2xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden animate-fade" style="animation-delay: ' + (i * 50) + 'ms">' +
                    '<div class="h-1.5 bg-gradient-to-r ' + colorClasses[m.color] + '"></div>' +
                    '<div class="p-5">' +
                        '<div class="flex items-center justify-between mb-3">' +
                            '<span class="text-sm font-medium text-slate-500 uppercase tracking-wide">' + m.titulo + '</span>' +
                            '<div class="p-2 rounded-xl bg-gradient-to-br ' + colorClasses[m.color] + ' text-white shadow-lg">' +
                                '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
                                    '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="' + m.icon + '"/>' +
                                '</svg>' +
                            '</div>' +
                        '</div>' +
                        '<div class="text-3xl font-bold text-slate-800 mb-1">' + formatNumber(m.valor) + '</div>' +
                        '<div class="text-sm text-slate-500">' + m.subtitulo + '</div>' +
                    '</div>' +
                '</div>';
            }).join('');
        }

        function renderFlujoVisual(totales) {
            document.getElementById('flujoVisual').innerHTML = 
                '<h3 class="text-lg font-semibold text-slate-700 mb-6 flex items-center gap-2">' +
                    '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
                        '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>' +
                    '</svg>' +
                    'Flujo de Pedidos' +
                '</h3>' +
                '<div class="flex items-center justify-between flex-wrap gap-4">' +
                    '<div class="flex flex-col items-center flex-1 min-w-[100px]">' +
                        '<div class="w-16 h-16 rounded-2xl bg-blue-500 flex items-center justify-center text-white shadow-lg mb-3">' +
                            '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
                                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"/>' +
                            '</svg>' +
                        '</div>' +
                        '<span class="text-2xl font-bold text-slate-800">' + formatNumber(totales.ordenes) + '</span>' +
                        '<span class="text-sm text-slate-500 mt-1">Ordenes</span>' +
                    '</div>' +
                    '<div class="hidden sm:block text-slate-300 text-2xl">‚Üí</div>' +
                    '<div class="flex flex-col items-center flex-1 min-w-[100px]">' +
                        '<div class="w-16 h-16 rounded-2xl bg-emerald-500 flex items-center justify-center text-white shadow-lg mb-3">' +
                            '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
                                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>' +
                            '</svg>' +
                        '</div>' +
                        '<span class="text-2xl font-bold text-slate-800">' + formatNumber(totales.facturadas) + '</span>' +
                        '<span class="text-sm text-slate-500 mt-1">Facturadas</span>' +
                    '</div>' +
                    '<div class="hidden sm:block text-slate-300 text-2xl">‚Üí</div>' +
                    '<div class="flex flex-col items-center flex-1 min-w-[100px]">' +
                        '<div class="w-16 h-16 rounded-2xl bg-cyan-500 flex items-center justify-center text-white shadow-lg mb-3">' +
                            '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">' +
                                '<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"/>' +
                            '</svg>' +
                        '</div>' +
                        '<span class="text-2xl font-bold text-slate-800">' + formatNumber(totales.remitidas) + '</span>' +
                        '<span class="text-sm text-slate-500 mt-1">Remitidas</span>' +
                    '</div>' +
                '</div>';
        }

        function renderFilaAgrupacion(item, tipo) {
            var icon = tipo === 'CANAL' ? getCanalIcon(item.Nombre) : getVendedorIcon(item.Nombre);
            var pctFacturado = calcularPorcentaje(item.Facturadas, item.Ordenes);
            var pctRemitido = calcularPorcentaje(item.Remitidas, item.Facturadas);

            return '<div class="bg-white rounded-xl shadow-md hover:shadow-lg transition-all duration-300 p-5 border border-slate-100">' +
                '<div class="flex items-center justify-between mb-4">' +
                    '<div class="flex items-center gap-3">' +
                        '<span class="text-2xl">' + icon + '</span>' +
                        '<span class="text-lg font-semibold text-slate-800">' + item.Nombre + '</span>' +
                    '</div>' +
                    '<span class="text-2xl font-bold text-slate-700">' + formatNumber(item.Ordenes) + '</span>' +
                '</div>' +
                
                '<div class="grid grid-cols-2 gap-4">' +
                    '<div class="space-y-2">' +
                        '<div class="flex justify-between text-sm">' +
                            '<span class="text-slate-600">Facturacion</span>' +
                            '<span class="font-medium text-emerald-600">' + pctFacturado + '%</span>' +
                        '</div>' +
                        '<div class="w-full bg-slate-100 rounded-full h-2.5 overflow-hidden">' +
                            '<div class="h-full rounded-full bg-gradient-to-r from-emerald-400 to-emerald-500 transition-all duration-700" style="width: ' + pctFacturado + '%"></div>' +
                        '</div>' +
                        '<div class="flex justify-between text-xs text-slate-500">' +
                            '<span>‚úì ' + formatNumber(item.Facturadas) + '</span>' +
                            '<span class="' + (item.PendFacturar > 0 ? 'text-amber-600 font-medium' : '') + '">‚è≥ ' + item.PendFacturar + '</span>' +
                        '</div>' +
                    '</div>' +
                    
                    '<div class="space-y-2">' +
                        '<div class="flex justify-between text-sm">' +
                            '<span class="text-slate-600">Remision</span>' +
                            '<span class="font-medium text-cyan-600">' + pctRemitido + '%</span>' +
                        '</div>' +
                        '<div class="w-full bg-slate-100 rounded-full h-2.5 overflow-hidden">' +
                            '<div class="h-full rounded-full bg-gradient-to-r from-cyan-400 to-cyan-500 transition-all duration-700" style="width: ' + pctRemitido + '%"></div>' +
                        '</div>' +
                        '<div class="flex justify-between text-xs text-slate-500">' +
                            '<span>üöö ' + formatNumber(item.Remitidas) + '</span>' +
                            '<span class="' + (item.SinRemitir > 0 ? 'text-rose-600 font-medium' : '') + '">‚ö†Ô∏è ' + item.SinRemitir + '</span>' +
                        '</div>' +
                    '</div>' +
                '</div>' +
                
                '<div class="mt-3 pt-3 border-t border-slate-100 flex justify-between text-xs text-slate-500">' +
                    '<span>$ Pend. Fact: <span class="font-medium text-amber-600">' + formatCurrency(item.ImportePendFacturar) + '</span></span>' +
                    '<span>$ Pend. Rem: <span class="font-medium text-rose-600">' + formatCurrency(item.ImportePendRemitir) + '</span></span>' +
                '</div>' +
            '</div>';
        }

        function renderDatos(datos) {
            // Separar canales y vendedores
            var canales = datos.filter(function(d) { return d.TipoAgrupacion === 'CANAL' && d.OrdenFila === 0; });
            var vendedores = datos.filter(function(d) { return d.TipoAgrupacion === 'VENDEDOR' && d.OrdenFila === 0; });
            var totalCanales = datos.find(function(d) { return d.TipoAgrupacion === 'CANAL' && d.OrdenFila === 1; });

            // Calcular totales para metricas
            var totales = {
                ordenes: totalCanales ? totalCanales.Ordenes : 0,
                facturadas: totalCanales ? totalCanales.Facturadas : 0,
                pendFacturar: totalCanales ? totalCanales.PendFacturar : 0,
                remitidas: totalCanales ? totalCanales.Remitidas : 0,
                sinRemitir: totalCanales ? totalCanales.SinRemitir : 0,
                importePendFact: totalCanales ? totalCanales.ImportePendFacturar : 0,
                importePendRem: totalCanales ? totalCanales.ImportePendRemitir : 0
            };

            // Renderizar
            renderMetricas(totales);
            renderFlujoVisual(totales);
            
            document.getElementById('canales').innerHTML = canales.map(function(c) { return renderFilaAgrupacion(c, 'CANAL'); }).join('');
            document.getElementById('vendedores').innerHTML = vendedores.map(function(v) { return renderFilaAgrupacion(v, 'VENDEDOR'); }).join('');

            // Actualizar timestamp
            document.getElementById('ultimaActualizacion').textContent = 
                'Ultima actualizacion: ' + new Date().toLocaleString('es-AR');
        }

        // =====================================================
        // CARGA DE DATOS
        // =====================================================

        async function cargarDatos() {
            var btn = document.getElementById('btnActualizar');
            var icon = document.getElementById('iconRefresh');
            var errorDiv = document.getElementById('errorMsg');
            
            btn.disabled = true;
            icon.classList.add('animate-spin');
            errorDiv.classList.add('hidden');

            try {
                var datos;

                if (CONFIG.USAR_DATOS_EJEMPLO) {
                    // Simular carga
                    await new Promise(function(resolve) { setTimeout(resolve, 500); });
                    datos = DATOS_EJEMPLO;
                } else {
                    // Cargar desde Apps Script
                    var response = await fetch(CONFIG.APPS_SCRIPT_URL);
                    if (!response.ok) throw new Error('Error al obtener datos');
                    var json = await response.json();
                    datos = json.data || json;
                }

                renderDatos(datos);

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('errorText').textContent = 
                    'Error al cargar los datos. Verifica la conexion.';
                errorDiv.classList.remove('hidden');
            } finally {
                btn.disabled = false;
                icon.classList.remove('animate-spin');
            }
        }

        // =====================================================
        // EVENTOS
        // =====================================================

        document.getElementById('btnActualizar').addEventListener('click', cargarDatos);
        document.getElementById('selectPeriodo').addEventListener('change', cargarDatos);

        // Cargar al inicio
        cargarDatos();

        // Auto-refresh cada 5 minutos
        setInterval(cargarDatos, 5 * 60 * 1000);
    </script>
</body>
</html>
